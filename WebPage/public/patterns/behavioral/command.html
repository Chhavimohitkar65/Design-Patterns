<!DOCTYPE html>
<html>
<head>
    <style>
        :root {
            --primary: #4299e1;
            --primary-dark: #3182ce;
            --success: #48bb78;
            --success-dark: #38a169;
            --danger: #f56565;
            --danger-dark: #e53e3e;
            --gray-50: #f8f9fa;
            --gray-100: #f7fafc;
            --gray-200: #e2e8f0;
            --gray-700: #718096;
            --gray-800: #2d3748;
            --gray-900: #1a202c;
        }

        body {
            font-family: 'Inter', -apple-system, 'Segoe UI', system-ui, sans-serif;
            margin: 0;
            padding: 20px;
            background: var(--gray-50);
            color: var(--gray-800);
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: white;
            padding: 2rem;
            border-radius: 16px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            margin-bottom: 2rem;
        }

        .header h1 {
            margin: 0 0 1rem;
            color: var(--gray-900);
            font-size: 2rem;
        }

        .definition {
            background: linear-gradient(to right, #e8f4ff, #f0f7ff);
            padding: 1.5rem;
            border-left: 4px solid var(--primary);
            border-radius: 12px;
            margin: 1.5rem 0;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        .definition h2 {
            margin: 0 0 0.5rem;
            color: var(--gray-900);
        }

        .editor-container {
            display: grid;
            grid-template-columns: 3fr 2fr;
            gap: 2rem;
            margin: 2rem 0;
        }

        .document-pane {
            background: white;
            padding: 2rem;
            border-radius: 16px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }

        #documentContent {
            min-height: 300px;
            border: 2px dashed var(--gray-200);
            padding: 1.5rem;
            margin: 1rem 0;
            border-radius: 12px;
            transition: all 0.3s ease;
            font-size: 1.1rem;
        }

        #documentContent:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.15);
        }

        .controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin: 1.5rem 0;
        }

        .button {
            background: var(--primary);
            color: white;
            border: none;
            padding: 0.75rem 1.25rem;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: 500;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .button:hover {
            background: var(--primary-dark);
            transform: translateY(-1px);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.15);
        }

        .button:active {
            transform: translateY(0);
        }

        .button.format {
            background: var(--success);
        }

        .button.format:hover {
            background: var(--success-dark);
        }

        .button.delete {
            background: var(--danger);
        }

        .button.delete:hover {
            background: var(--danger-dark);
        }

        .queue-panel {
            background: white;
            padding: 2rem;
            border-radius: 16px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .queue-list {
            flex-grow: 1;
            max-height: 400px;
            overflow-y: auto;
            border: 2px dashed var(--gray-200);
            border-radius: 12px;
            padding: 1rem;
            scrollbar-width: thin;
            scrollbar-color: var(--primary) var(--gray-100);
        }

        .queue-item {
            padding: 1rem;
            margin: 0.5rem 0;
            background: var(--gray-100);
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.2s ease;
            border: 1px solid var(--gray-200);
        }

        .queue-item:hover {
            transform: translateX(5px);
            background: white;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        .history-panel {
            background: var(--gray-900);
            color: #a0aec0;
            padding: 1.5rem;
            border-radius: 12px;
            margin-top: 2rem;
            font-family: 'Monaco', 'Consolas', monospace;
            max-height: 200px;
            overflow-y: auto;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .history-panel:empty::before {
            content: 'No commands executed yet';
            color: var(--gray-700);
            font-style: italic;
        }

        .badge {
            padding: 0.25rem 0.75rem;
            border-radius: 999px;
            font-size: 0.875rem;
            background: var(--primary);
            color: white;
            font-weight: 500;
        }

        .command-type {
            font-weight: 600;
            color: var(--primary);
        }

        .timestamp {
            color: var(--gray-700);
            font-size: 0.875rem;
        }

        /* Text formatting styles */
        .bold { font-weight: 700; }
        .italic { font-style: italic; }
        .underline { text-decoration: underline; }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .editor-container {
                grid-template-columns: 1fr;
            }

            .container {
                padding: 10px;
            }

            .controls {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Command Pattern Text Editor</h1>
            <div class="definition">
                <h2>Overview</h2>
                <p>This text editor demonstrates the Command pattern by encapsulating text operations as objects. Each operation can be queued, executed, and undone, providing a flexible way to manage document modifications.</p>
            </div>
        </div>

        <div class="editor-container">
            <div class="document-pane">
                <h2>Document Content</h2>
                <div id="documentContent" contenteditable="true"></div>
                <div class="controls">
                    <button class="button" onclick="queueCommand(new InsertCommand('Hello! '))">
                        Insert "Hello!"
                    </button>
                    <button class="button delete" onclick="queueCommand(new DeleteCommand(5))">
                        Delete Last 5
                    </button>
                    <button class="button format" onclick="queueCommand(new FormatCommand('bold'))">
                        Toggle Bold
                    </button>
                    <button class="button format" onclick="queueCommand(new FormatCommand('italic'))">
                        Toggle Italic
                    </button>
                </div>
            </div>

            <div class="queue-panel">
                <h2>Command Queue</h2>
                <button class="button" onclick="executeQueue()">
                    Execute All Commands
                </button>
                <button class="button delete" onclick="undoLastCommand()">
                    Undo Last Command
                </button>
                <div class="queue-list" id="commandQueue"></div>
            </div>
        </div>

        <div class="history-panel" id="commandHistory"></div>
    </div>

    <script>
        class Command {
            execute() {}
            undo() {}
            description() {}
        }

        class InsertCommand extends Command {
            constructor(text) {
                super();
                this.text = text;
                this.previousContent = '';
                this.position = 0;
            }

            execute(doc) {
                this.previousContent = doc.content;
                this.position = doc.content.length;
                doc.content += this.text;
                return `Inserted "${this.text}" at position ${this.position}`;
            }

            undo(doc) {
                doc.content = this.previousContent;
                return `Removed "${this.text}" from position ${this.position}`;
            }

            description() {
                return `Insert: "${this.text}"`;
            }
        }

        class DeleteCommand extends Command {
            constructor(count) {
                super();
                this.count = count;
                this.deletedText = '';
                this.position = 0;
            }

            execute(doc) {
                if (doc.content.length < this.count) {
                    return `Cannot delete ${this.count} characters from text of length ${doc.content.length}`;
                }
                this.position = doc.content.length - this.count;
                this.deletedText = doc.content.slice(-this.count);
                doc.content = doc.content.slice(0, -this.count);
                return `Deleted "${this.deletedText}" from position ${this.position}`;
            }

            undo(doc) {
                doc.content += this.deletedText;
                return `Restored "${this.deletedText}" at position ${this.position}`;
            }

            description() {
                return `Delete: last ${this.count} characters`;
            }
        }

        class FormatCommand extends Command {
            constructor(style) {
                super();
                this.style = style;
                this.previousStyles = [];
                this.wasActive = false;
            }

            execute(doc) {
                this.previousStyles = [...doc.styles];
                this.wasActive = doc.styles.includes(this.style);
                
                if (this.wasActive) {
                    doc.styles = doc.styles.filter(s => s !== this.style);
                    return `Removed ${this.style} formatting`;
                } else {
                    doc.styles.push(this.style);
                    return `Applied ${this.style} formatting`;
                }
            }

            undo(doc) {
                doc.styles = this.previousStyles;
                return `Restored previous ${this.style} formatting state`;
            }

            description() {
                return `Format: toggle ${this.style}`;
            }
        }

        class DocumentEditor {
            constructor() {
                this.commandQueue = [];
                this.history = [];
                this.document = {
                    content: 'Start typing or use the buttons below...',
                    styles: []
                };
                this.setupEventListeners();
            }

            setupEventListeners() {
                const contentEl = document.getElementById('documentContent');
                contentEl.addEventListener('input', () => {
                    this.document.content = contentEl.textContent;
                });
            }

            queueCommand(command) {
                this.commandQueue.push(command);
                this.updateQueueDisplay();
            }

            executeQueue() {
                if (this.commandQueue.length === 0) {
                    this.logCommand('No commands in queue');
                    return;
                }

                this.commandQueue.forEach(command => {
                    const result = command.execute(this.document);
                    this.history.push(command);
                    this.logCommand(result);
                });

                this.commandQueue = [];
                this.updateQueueDisplay();
                this.updateDocumentDisplay();
            }

            undoLast() {
                const command = this.history.pop();
                if (command) {
                    const result = command.undo(this.document);
                    this.logCommand(result);
                    this.updateDocumentDisplay();
                } else {
                    this.logCommand('No commands to undo');
                }
            }

            updateDocumentDisplay() {
                const contentEl = document.getElementById('documentContent');
                contentEl.textContent = this.document.content;
                contentEl.className = this.document.styles.join(' ');
            }

            updateQueueDisplay() {
                const queueEl = document.getElementById('commandQueue');
                queueEl.innerHTML = this.commandQueue.length === 0 ? 
                    '<div class="queue-item">No commands in queue</div>' :
                    '';

                this.commandQueue.forEach((command, index) => {
                    const item = document.createElement('div');
                    item.className = 'queue-item';
                    item.innerHTML = `
                        <span class="command-type">${command.constructor.name}</span>
                        <span>${command.description()}</span>
                        <span class="badge">#${index + 1}</span>
                    `;
                    queueEl.appendChild(item);
                });
            }

            logCommand(message) {
                const historyEl = document.getElementById('commandHistory');
                const entry = document.createElement('div');
                entry.innerHTML = `
                    <span class="timestamp">[${new Date().toLocaleTimeString()}]</span>
                    ${message}
                `;
                historyEl.appendChild(entry);
                historyEl.scrollTop = historyEl.scrollHeight;
            }
        }

        const editor = new DocumentEditor();
        
        function queueCommand(command) {
            editor.queueCommand(command);
        }

        function executeQueue() {
            editor.executeQueue();
        }

        function undoLastCommand() {
            editor.undoLast();
        }

        // Initial setup
        editor.updateDocumentDisplay();
    </script>
</body>
</html>